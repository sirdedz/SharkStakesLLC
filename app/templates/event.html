<!-- Event page -->
<!DOCTYPE html>

{% extends "base.html" %}

{% block content %}
    <script type="text/javascript"> window.event_id = "{{event.id}}"
        $("#eventChart").ready(function(){
            drawResults(event_id);
        });
    </script>

    <!-- <h2 id="eventTitle">{{event.title}}</h2> -->
    <div class="deconstructed">
        {{event.sport}}
        <div>{{event.sport}}</div>
        <div>{{event.sport}}</div>
    </div>
    <h2 id="eventTitle">
        {{ event.title }}
    </h2>

    <div id="eventChartDiv">
        <canvas id="eventChart" style="height: 200px;"></canvas>
    </div>

    <button id="createListing" onclick="createListing({{event.id}})">
        Create A Listing
    </button>

    <div id="createListingPopup" class="hidden">
        <div id="createListingClose" onclick="createListingClose()">
            X
        </div>
        <!--
            Info needed:
            - Event
            - Selected option/outcome
            - Selected Odds
            - Odds this will be listed as for the other person
            - Current best odds
            - Return if the bet is successful
            - DateTime
            - User ID
            - Users current balance
            - T&C's
        -->
        <table>
            <tbody>
                <tr>
                    <td colspan="2">
                        <h2>
                            {{event.title}}
                        </h2>
                        <h8>
                            MAKE A LISTING
                        </h8>
                    </td>
                </tr>
                <tr>
                    <td colspan="2">
                        <div>
                            You bet
                            <select>
                                <option>
                                    For all option in options
                                </option>
                            </select>

                            to win.
                        </div>
                    </td>
                </tr>
                <tr>
                    <td>
                        Enter Your Odds: <input type="number"/>
                    </td>
                    <td>
                        Their Odds on other option to win: <input type="number"/>
                    </td>
                </tr>
                <tr>
                    <td>

                    </td>
                    <td>
                        Current best odds for other option: XXX
                    </td>
                </tr>
                <tr>
                    <td>
                        Amount: 
                        <input type="number"/>
                    </td>
                    <td>
                        Return: XXX
                    </td>
                </tr>
                <tr>
                    <td colspan="2">
                        Current Balance: XXX
                    </td>
                </tr>
                <tr>
                    <td colspan="2">
                        Terms and Conditions
                    </td>
                </tr>
                <tr>
                    <td colspan="2">
                        <input type="submit" value="BET"/>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <table id="eventTable" class="sortable">
        <thead>
          <tr>
            <th scope="col">User</th>
            <th scope="col">Their Pick</th>
            <th scope="col">Your Pick</th>
            <th scope="col">Your Odds</th>
            <th scope="col">Amount</th>
            <th scope="col">Return</th>
            <th scope="col">DateTime</th>
            <th scope="col">MATCH</th>
            {% if current_user.username == 'admin' %}
                <th scope="col">Delete</th>
            {% endif %}
          </tr>
        </thead>

        <tbody>
            {% for listing in listings %}
            <tr>
                <td>{{ listing.username }}</td>
                <td>{{listing.option}}</td>
                <td>
                    {% set first = 'True' %}
                    {% for option in listing.other_options %}

                        {{option.pick}}

                        {% if not loop.last %}
                            or
                        {% endif %}

                    {% endfor %}
                </td>
                <td>{{listing.odds}}</td>
                <td>{{listing.amount}}</td>
                <td>{{'%.02f' | format(listing.amount * listing.odds | float)}}</td>
                <td>{{listing.daymonth}}</td>
                <td><a href="#">MATCH</a></td>
                {% if current_user.username == 'admin' %}
                    <td><a href={{ url_for('delete_quiz', title=event.title) }}>DEL</a></td>
                {% endif %}
            </tr>
            {% endfor %}
        </tbody>
    </table>

{% endblock %}
